
<div id="post-<%= post._id %>" class="post-list">

        <div class="user-info">
            <div class="user-post-details">
                <a href="/users/profile/<%= post.user.id %>">
                    <div class="user-name-pic">
                        <img data-src="<%= post.user.avatar %>" alt="" onerror="this.onerror=null;this.src='/images/Users-avatar.png';">
                        <% if (locals.user && locals.user.name == post.user.name){ %>
                            <span>You</span>
                        <% }else{ %>
                            <span><%= post.user.name %></span>
                        <% } %>
                    </div>
                </a>
                <br>
                <small><%= new Date(post.createdAt).toString().substring(4,16) %> at <%= new Date(post.createdAt).toString().substring(16, 21) %></small>
            </div>

            <span class="post-comment-more-icon" id="post-comment-more-icon-<%= post.id %>">
                <i class="fas fa-ellipsis-h"></i>
            </span>

            <span class="post-comment-close-icon" id="post-comment-close-icon-<%= post.id %>">
                <i class="far fa-times-circle"></i>
            </span>

            <ul class="post-comment-more-options animate__animated animate__flipInX" id="post-comment-more-options-<%= post.id %>">
                 <!-- Delete a post -->
                <% if (locals.user && locals.user.id == post.user.id){ %>
                <a class="delete-post-button" href="/posts/destroy/<%= post.id %>">
                    <li>
                        <span style="margin-right: 5px; color: #b75a5a;"><i class="fas fa-trash-alt"></i></span>
                        Delete Post
                    </li>
                </a>

                <% }else{ %>

                <a href="/users/profile/<%= post.user.id %>">
                    <li>
                        <span style="margin-right: 5px; color: #4a4aaf;"><i class="fas fa-id-card"></i></span>
                        View Profile
                    </li>
                </a>
                <a href="/">
                    <li>
                        <span style="margin-right: 5px; color: red"><i class="fas fa-flag-checkered"></i></span>
                        Report Post
                    </li>
                </a>

                <% } %>

                <!-- If image or video is availavle -->
                <% if(post.postPath){ %>
                <a href="<%= post.postPath %>" download target="_blank">
                    <li>
                        <span style="margin-right: 5px; color: #688968;"><i class="fas fa-download"></i></span>
                        Download
                    </li>
                </a>
                <% } %>
            </ul>
        </div>

        <div class="post-content">
            <%- post.content %>
        </div>

        <% if(post.postPath){ %>
            <div class="post-image-video">
                <% if(post.mediaType == 'video'){ %>
                    <video class="post-video" data-src="<%= post.postPath %>" controls onerror="this.onerror=null;this.style='display:none';"></video>
                <% }else{ %>
                    <img class="post-image" data-src="<%= post.postPath %>" onload="this.style='opacity:1';" onerror="this.onerror=null;this.style='display:none';">
                    <!-- Good attribute for lazy image loading -------- loading="lazy" -->
                <% } %>
                <!-- Loading animation -->
                <div class="post-image-video-loading loadingio-spinner-eclipse-8jfbkc15oik"><div class="ldio-zwmxbg1ll"><div></div></div></div>
            </div>
        <% } %>

        <div class="user-controls">
             <!-- Display the likes of this post, if the user is logged in, then show the link to toggle likes, else, just show the count -->
            <div class="likes-container">
                <% if (locals.user){ %>
                <a class="toggle-like-button" data-likes="<%= post.likes.length %>" href="/likes/toggle/?id=<%=post._id%>&type=Post">
                    <div class="likes-count">
                        <span><%= post.likes.length %></span>
                        <span>
                            <i class="far fa-thumbs-up"></i>
                            <span style="color: blue;">Likes</span>
                        </span>
                    </div>
                </a>
                <% }else{ %>
                <div class="likes-count">
                    <span><%= post.likes.length %></span>
                    <span>
                        <i class="far fa-thumbs-up"></i>
                        <span style="color: blue;">Likes</span>
                    </span>
                </div>
                <% } %>
            </div>

            <div class="comments-container" id="comments-container-<%=post._id%>" data-closed="true" data-posterId="<%=post.user._id%>" data-fetched="false">
                <div class="comments-count">
                    <span id="comments-count-<%=post._id%>"><%= post.comments.length %></span>
                    <span>
                        <i class="fas fa-comment-alt"></i> Comments 
                        <i class="fas fa-caret-down"></i>
                    </span>
                </div>
            </div>
        </div>


        <div class="post-comments" id="post-comments-<%=post._id%>">
            <% if (locals.user){ %>
                <!-- let's give an id to the new comment form, we'll also need to make the same changes in home_posts.js where we're adding a post to the page -->
                <form id="post-<%= post._id %>-comments-form" action="/comments/create" method="POST" autocomplete="off">
                    <textarea type="text" name="content" placeholder="Type Here to add comment..." required></textarea>
                    <input type="hidden" name="post" value="<%= post._id %>" >
                    <input type="submit" value="Comment">
                </form>
            <% } %>
            
            <div class="post-comments-list">
                <div id="post-comments-list-<%= post._id %>">
                    <!-- Here _comment.ejs file was there before ajax was implemented -->
                    <div class="comment-loading-animation">
                        <div class="loadingio-spinner-spin-8soird73u5f"><div class="ldio-96l53ffv5hg">
                            <div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div>
                            </div></div>
                    </div>
                </div>
            </div>
        </div>

    </div>