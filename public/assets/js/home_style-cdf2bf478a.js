{function handleMultilineTextAreaInput(e){$(e).keydown((function(e){let t=e.target,n=t.value;if(9===e.keyCode){e.preventDefault();var o=this.selectionStart,s=this.selectionEnd;t.value=n.substring(0,o)+"\t"+n.substring(s),this.selectionStart=this.selectionEnd=o+1}})),$(e).on("input",(function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"}))}function toggleCommentSection(e){e.click((function(t){if("true"==e.attr("data-closed")){$(" .fa-caret-down",e).css({transform:"rotateX(180deg)"});let t=e.prop("id").split("-")[2],n=e.attr("data-posterId");$("#post-comments-"+t).css({"max-height":"1000px"});let o=$("#post-comments-list-"+t);"false"==e.attr("data-fetched")&&($(" .comment-loading-animation",o).css("display","flex"),$.ajax({type:"get",url:"/comments/fetch/?postId="+t,success:function(t){if($(" .comment-loading-animation",o).css("display","none"),t.data.comment&&t.data.comment.length>0){for(let e of t.data.comment){let s=prepareComments(e,t.data.loggedInUserId,n);o.append(s),showPostCommentMoreOption($("#post-comment-more-icon-"+e._id)),new ToggleLike($(" .toggle-like-button",s)),deleteCommentAjax($(" .delete-comment-button",s))}scrollToBottomOfComment(o.parent()[0])}else console.log("No comments found");e.attr("data-fetched","true")},error:function(e){console.log(e.responseText)}})),e.attr("data-closed","false"),scrollToBottomOfComment(o.parent()[0])}else{$(" .fa-caret-down",e).css({transform:"rotateX(0deg)"});let t=e.prop("id").split("-")[2];$("#post-comments-"+t).css({"max-height":"0px"}),e.attr("data-closed","true")}}))}function scrollToBottomOfComment(e){}function showPostCommentMoreOption(e){e.click((function(t){e.css({"background-color":"grey",display:"none"});let n=e.prop("id").split("-")[4];$("#post-comment-more-options-"+n).css({display:"block"}),$("#post-comment-close-icon-"+n).css({display:"initial"})}))}function closePostCommentMoreOption(){$(document).mouseup((function(e){0===$(e.target).closest(".post-comment-more-options").length&&($(".post-comment-more-options").hide(),$(".post-comment-more-icon").css({"background-color":"initial",display:"initial"}),$(".post-comment-close-icon").css({display:"none"}))}))}function prepareComments(e,t,n){return $(`\n        <div id="comment-${e._id}" class="comment-list-container">\n            <div class="comment-user-info">\n                <div class="user-comment-details">\n                    <a href="/users/profile/${e.user._id}">\n                        <div class="comment-user-name-pic">\n                            <img src="${e.user.avatar}" alt="img" onerror="this.onerror=null;this.src='/images/Users-avatar.png';">\n                            ${t==e.user._id?"<span>You</span>":`<span>${e.user.name}</span>`}\n                        </div>\n                    </a>\n                    <br>\n                    <small>${new Date(e.createdAt).toString().substring(4,16)} at ${new Date(e.createdAt).toString().substring(16,21)}</small>\n                </div>\n                <span class="post-comment-more-icon" id="post-comment-more-icon-${e._id}">\n                    <i class="fas fa-ellipsis-h"></i>\n                </span>\n                <span class="post-comment-close-icon" id="post-comment-close-icon-${e._id}">\n                    <i class="far fa-times-circle"></i>\n                </span>\n\n                <ul class="post-comment-more-options animate__animated animate__flipInX" id="post-comment-more-options-${e._id}">\n                    \x3c!-- Delete a comment --\x3e\n                    ${t==e.user._id||t==n?`<a class="delete-comment-button" href="/comments/destroy/?id=${e._id}&post_user_id=${n}">\n                                <li>Delete Comment</li>\n                            </a>`:`<a href="/users/profile/${e.user._id}">\n                                <li>View Profile</li>\n                            </a>\n                            <a href="/">\n                                <li>Report Comment</li>\n                            </a>`}\n                </ul>\n            </div>\n\n            <div class="comment-content">\n                ${e.content}\n            </div>\n\n            <div class="comment-user-controls">\n                \x3c!-- Display the likes of this comment, if the user is logged in, then show the link to toggle likes, else, just show the count --\x3e\n                <div class="comment-likes-container">\n                ${t?`\n                    <a class="toggle-like-button" data-likes="${e.likes.length}" href="/likes/toggle/?id=${e._id}&type=Comment">\n                        <div class="likes-count">\n                            <span>${e.likes.length}</span>\n                            <span>\n                                <i class="far fa-thumbs-up"></i>\n                                <span style="color: blue;">Likes</span>\n                            </span> \n                        </div>\n                    </a>\n                `:`\n                    <div class="likes-count">\n                        <span>${e.likes.length}</span>\n                        <span>\n                            <i class="far fa-thumbs-up"></i>\n                            <span style="color: blue;">Likes</span>\n                        </span>\n                    </div>\n                `}\n                </div>\n            </div>\n\n        </div>   \n        `)}$("textarea").each((function(){handleMultilineTextAreaInput($(this))})),$(".comments-container").each((function(){toggleCommentSection($(this))})),$(".post-comment-more-icon").each((function(){showPostCommentMoreOption($(this))})),closePostCommentMoreOption(),function(){if("IntersectionObserver"in window){let e=document.querySelectorAll(".post-list [data-src]"),t={root:document.getElementById("feed-posts"),rootMargin:"400px"},n=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){let n=e.target;n.src=n.dataset.src,t.unobserve(n)}}))}),t);e.forEach((function(e){n.observe(e)}))}else{var e;function t(){console.log("Called"),e&&clearTimeout(e),e=setTimeout((function(){let e=document.querySelectorAll(".post-list [data-src]");e.forEach((function(e){e.getBoundingClientRect().top<=window.innerHeight+400&&(e.src=e.dataset.src,e.removeAttribute("data-src"))})),0==e.length&&(console.log("All are visited"),$("#feed-posts").off("scroll",t),$("#feed-posts").off("resize",t),$("#feed-posts").off("orientationchange",t))}),20)}t(),$("#feed-posts").on("scroll resize orientationchange",t)}}()}