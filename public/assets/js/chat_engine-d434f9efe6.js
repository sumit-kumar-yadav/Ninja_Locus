class ChatEngine{constructor(e,o,t){console.log(t,"userId"),this.chatBox=$("#"+e),this.userEmail=o,this.userId=t,this.room="",this.socket=io.connect("http://localhost:5000"),this.userEmail&&this.connectionHandler()}connectionHandler(){let e=this;this.socket.on("connect",(function(){console.log("connection established using sockets...!",e.userId),e.socket.emit("loggedin",e.userId),$("#user-chat-box").hide()})),e.socket.on("invite",(function(o){console.log("Invitation received to join a room"),console.log("Invition accepted to join the room"),e.socket.emit("joinRoom",o),$(`span[data-room="${o.room.room}"]`).attr("data-room-created","true")})),$("#send-message").click((function(){let o=$("#chat-message-input").val();console.log("After mgs is clicked: ");let t=$("#chat-message-input-container button").attr("data-room");""!=o&&"null"!=t&&($("#chat-message-input").val(""),e.socket.emit("send_message",{message:o,user_email:e.userEmail,room:t}))})),e.socket.on("receive_message",(function(o){console.log("message received",o.message),$("#user-chat-box").show();let t=$("#chat-message-input-container button").attr("data-room");if("null"==t||t==o.room){let t=$("<li>"),s="other-message";o.user_email==e.userEmail&&(s="self-message"),t.append($("<span>",{html:o.message})),t.append($("<sub>",{html:o.user_email})),t.addClass(s),$("#chat-messages-list").append(t),$("#chat-message-input-container button").attr("data-room",o.room)}else{$(`span[data-room="${o.room}"]`).append("<b> &ensp; mgs </b>")}}))}createRoom(e){console.log("createRoom function is called with id",e);let o=$(`#chat-${e} span`).attr("data-room-created");console.log("isRoomExist value: ",o,$(`#chat-${e} span`));let t=$(`#chat-${e} span`).attr("data-room");"false"==o?(console.log("Room created successfully by you, room is: ",t),this.socket.emit("create",{room:t,userId:this.userId,withUserId:e}),$(`#chat-${e} span`).attr("data-room-created","true"),this.openChatWindow(t)):(console.log("Room already exists"),this.openChatWindow(t))}openChatWindow(e){$("#user-chat-box").show(),$("#chat-message-input-container button").attr("data-room",e),console.log("New chat window opened")}}