class ChatEngine{constructor(o,e,s){console.log(s,"userId"),this.chatBox=$("#"+o),this.userEmail=e,this.userId=s,this.room="",this.socket=io.connect("http://localhost:5000"),this.userEmail&&this.connectionHandler()}connectionHandler(){let o=this;this.socket.on("connect",(function(){console.log("connection established using sockets...!",o.userId),o.socket.emit("loggedin",o.userId)})),o.socket.on("invite",(function(e){console.log("Invitation received to join a room"),o.room=e.room.room,console.log("joining room is: ",o.room),o.socket.emit("joinRoom",e)})),$("#send-message").click((function(){let e=$("#chat-message-input").val();console.log("After mgs is clicked: ",o.room),""!=e&&""!=o.room&&($("#chat-message-input").val(""),o.socket.emit("send_message",{message:e,user_email:o.userEmail,room:o.room}))})),o.socket.on("receive_message",(function(e){console.log("message received",e.message),$("#user-chat-box").show();let s=$("<li>"),t="other-message";e.user_email==o.userEmail&&(t="self-message"),s.append($("<span>",{html:e.message})),s.append($("<sub>",{html:e.user_email})),s.addClass(t),$("#chat-messages-list").append(s)}))}createRoom(o){console.log("createRoom function is called with id",o),this.room=Date.now()+Math.random(),this.room=this.room.toString().replace(".","_"),console.log("room is",this.room),this.socket.emit("create",{room:this.room,userId:this.userId,withUserId:o}),this.openChatWindow(this.room)}openChatWindow(o){$("#user-chat-box").show()}}